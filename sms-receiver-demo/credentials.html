<!DOCTYPE html>
<meta charset="utf-8">
<title>SMS Receiver API Demo</title>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="origin-trial" content="AszQhqVLF0OZ3bxUDjDXH8u7nRF0EOEbgptw2XY8n9S5MjoIubzKS/BBF7oVLOGMK6DautN4vmO9ehpyfi+FwAAAAABXeyJvcmlnaW4iOiJodHRwczovL2F5dWlzaGlpLmdpdGh1Yi5pbzo0NDMiLCJmZWF0dXJlIjoiU21zUmVjZWl2ZXIiLCJleHBpcnkiOjE1NzkwMzk1MDV9">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
</head>
<body>
<div class="container" style="text-align:center">
<h2>OTP Credentials Test</h2>
  <p>
    <button onclick="startReceive(count)" class="btn btn-success" style="width:100%">
      Trigger request
    </button>
  </p>
  <p>
    <div>OTP Is: <input id="otp"></input><div>
  </p>
</div>

<script>

async function main() {
  if (!navigator.credentials) {
    alert("feature not available :(");
    return;
  }
}

let count = 1;

function startReceive(num) {
  navigator.credentials.get({otp: {transport: ["sms"]}})
    .then(cred => {
      document.getElementById("otp").value = cred.code;
    })
    .catch(e => {
      alert("error " + num + " receive: " + e.name + ": " + e.message);
    });
  count += 1;
}

main();
</script>
</body>
