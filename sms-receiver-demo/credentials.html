<!DOCTYPE html>
<meta charset="utf-8">
<title>SMS Receiver API Demo</title>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="origin-trial" content="AszQhqVLF0OZ3bxUDjDXH8u7nRF0EOEbgptw2XY8n9S5MjoIubzKS/BBF7oVLOGMK6DautN4vmO9ehpyfi+FwAAAAABXeyJvcmlnaW4iOiJodHRwczovL2F5dWlzaGlpLmdpdGh1Yi5pbzo0NDMiLCJmZWF0dXJlIjoiU21zUmVjZWl2ZXIiLCJleHBpcnkiOjE1NzkwMzk1MDV9">
</head>
<body>
OTP Credentials Test

<div>
  <button onclick="startReceive(count)">Trigger request</button>
  <div>OTP Is: <span id="otp"></span><div>
  <div>Message Is: <span id="message"></span><div>
</div>

<script>

async function main() {
  if (!navigator.credentials) {
    alert("feature not available :(");
    return;
  }
}

let count = 1;

function startReceive(num) {
  navigator.credentials.get({otp: {transport: ["sms"]}})
    .then(cred => {
      document.getElementById("otp").value = cred.id;
      alert("otp " + num + " received: " + cred.id + " - " + cred.otp);
    })
    .catch(e => {
      document.getElementById("otp").value = e.name;
      alert("error " + num + " receive: " + e.name);
    });
  count += 1;
}

main();
</script>
</body>
