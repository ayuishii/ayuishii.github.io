<!DOCTYPE html>
<meta charset="utf-8">
<title>SMS Receiver API Demo</title>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="origin-trial" content="AszQhqVLF0OZ3bxUDjDXH8u7nRF0EOEbgptw2XY8n9S5MjoIubzKS/BBF7oVLOGMK6DautN4vmO9ehpyfi+FwAAAAABXeyJvcmlnaW4iOiJodHRwczovL2F5dWlzaGlpLmdpdGh1Yi5pbzo0NDMiLCJmZWF0dXJlIjoiU21zUmVjZWl2ZXIiLCJleHBpcnkiOjE1NzkwMzk1MDV9">
</head>
<body>
Trigger multiple requests.

<div>
  <button onclick="startReceive(count)">Trigger new request</button>
</div>

<script>

async function main() {
  if (!navigator.credentials) {
    alert("feature not available :(");
    return;
  }
  navigator.credentials.get({otp: true})
    .then(sms => {
      alert("initial sms received - " + sms.content);
    })
    .catch( e => {
      alert("initial error receive - " + e.name);
    });
}

let count = 1;

function startReceive(num) {
  navigator.credentials.get({otp: true})
    .then(sms => {
      alert("sms " + num + " received - " + sms.content);
    })
    .catch(e => {
      alert("error " + num + " receive - " + e.name);
    });
  count += 1;
}

main();
</script>
</body>
